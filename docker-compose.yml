version: "3"

services:
  base-api:
    restart: always
    container_name: api-boilerplate
    env_file: .env
    build: 
      context: .
      dockerfile: Dockerfile
    command: yarn start
    image: ${API_NAME_TAG}
    ports:
      - "5000:3000"
    networks:
      - backend-cluster

  nginx:
    image: nginx:alpine
    container_name: backend-nginx
    restart: always
    ports:
      - 8080:80
    volumes:
      - ./nginx/conf.d:/etc/nginx/conf.d
    networks:
      - backend-cluster
    depends_on:
      - base-api

networks:
  backend-cluster:
    driver: "bridge"
